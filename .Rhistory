x ="Province",
y = "% points of the FP GAP",
caption = loli_caption) +
theme(panel.background = element_rect(fill = "gray98",
colour = "black"),
plot.caption = element_text(hjust = 0),
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust=0.5),
legend.box.just = c("right","center"),
axis.text.x = element_text(size=7, angle = 60, vjust = 1, hjust=1)) +
geom_hline(yintercept=0,
linetype="dashed",
color = "black",
size= 0.9,
alpha= 0.8)
lollitplot4
chw_fp$aver_sup_chw <- chw_fp$n_supervision / chw_fp$report_ape
boxplot_title = "Distribution of average number of supervisions per community health worker"
source = "Source: Health Information System"
base = ggplot(chw_fp,aes(y=aver_sup_chw, x=''))
box1  = base + geom_boxplot()
box2 = box1 + labs(title=boxplot_title,
x =NULL,
y = 'Number of supervisions per community health worker',
caption = source)
box3= box2 + scale_y_continuous(breaks=1:15)
box4 = box3 + theme(panel.background = element_rect(fill = "white",
colour = "grey50"),
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust=0))
box4+ coord_flip()
scat1_title = " title..."
base = ggplot(chw_fp, aes(x=report_ape, y=ape_contrib, label=province)) +
geom_point() + geom_text_repel()
scat1 = base + labs(title=scat1_title,
x ="Total women of reproductive age",
y = 'Community health worker contribution',
caption = source)
scat1
scat2_title = " Average Number of Active CHW to Each Province's Contribution"
base111=ggplot(data=chw_fp,aes (x=report_ape,
y=ape_contrib, label=province))+geom_point(size=3)+ geom_text_repel()
base111=base111+labs(title=scat2_title,
x ="Average Number of Active CHW",
y = 'Contribution in Each Province',
caption = source)
base111
install.packages("utilsIPEA", repos = "http://cran.us.r-project.org")
install.packages("rgdal", repos = "http://cran.us.r-project.org")
install.packages("raster", repos = "http://cran.us.r-project.org")
install.packages("tmaptools", repos = "http://cran.us.r-project.org")
#install.packages("mapshaper", repos = "http://cran.us.r-project.org")
install.packages("tmap", repos = "http://cran.us.r-project.org")
install.packages("leaflet", repos = "http://cran.us.r-project.org")
install.packages("RColorBrewer", repos = "http://cran.us.r-project.org")
install.packages("classInt", repos = "http://cran.us.r-project.org")
install.packages("dplyr", repos = "http://cran.us.r-project.org")
library(utilsIPEA)
library(rgdal)
library(raster)
library(tmaptools)
#library(mapshaper)
library(tmap)
library(leaflet)
library(RColorBrewer)
library(classInt)
library(dplyr)
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
library ("haven")
library("ggplot2")
library("foreign")
#link="https://github.com/quinhasf/pubpol-599/raw/master/ape_analysis.dta"
#chw_fp <- read_dta(url(link))
link="https://github.com/ihsun-uw/Group3_Final_Project/raw/master/child_mortality.dta"
df <- read_dta(url(link))
zip_mozmap_SHP = "https://github.com/ihsun-uw/Group3_Final_Project/raw/master/Mozambique%20shape%20maps.zip"
library(utils)
temp=tempfile()
download.file(zip_mozmap_SHP, temp)
unzip(temp)
#DMC - showing which tempfiles are in the directory
(maps=list.files(pattern = 'shp'))
# notice the parameters use in the chunk!!
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
install.packages("utilsIPEA", repos = "http://cran.us.r-project.org")
install.packages("rgdal", repos = "http://cran.us.r-project.org")
install.packages("tmaptools", repos = "http://cran.us.r-project.org")
install.packages("raster", repos = "http://cran.us.r-project.org")
install.packages("tmap", repos = "http://cran.us.r-project.org")
install.packages("RColorBrewer", repos = "http://cran.us.r-project.org")
install.packages("leaflet", repos = "http://cran.us.r-project.org")
install.packages("classInt", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("dplyr", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
install.packages("tmaptools", repos = "http://cran.us.r-project.org")
install.packages("RColorBrewer", repos = "http://cran.us.r-project.org")
install.packages("raster", repos = "http://cran.us.r-project.org")
install.packages("tmap", repos = "http://cran.us.r-project.org")
install.packages("leaflet", repos = "http://cran.us.r-project.org")
install.packages("classInt", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("dplyr", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
install.packages("raster", repos = "http://cran.us.r-project.org")
install.packages("tmap", repos = "http://cran.us.r-project.org")
install.packages("RColorBrewer", repos = "http://cran.us.r-project.org")
install.packages("classInt", repos = "http://cran.us.r-project.org")
install.packages("dplyr", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("tmap", repos = "http://cran.us.r-project.org")
install.packages("RColorBrewer", repos = "http://cran.us.r-project.org")
install.packages("dplyr", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("dplyr", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("foreign", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
install.packages("haven", repos = "http://cran.us.r-project.org")
legendText="u5 mortality rate"
shrinkLegend=1
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col='red',main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
plot(mozzipMap)
str(chw_fp$province)
str(mozzipMap)
head(chw_fp$province, 10)
names(mozzipMap)
head(mozzipMap$CAPTION, 50)
str(mozzipMap$CAPTION)
#mozzipMap$CAPTION=as.numeric(mozzipMap$CAPTION)
mozzipMap
#SchoolData$Grade[SchoolData$Grade==5] <- "Grade Five"
chw_fp$province_num <- chw_fp$province
chw_fp$province_num[chw_fp$province=="CABO DELGADO"] <- 1
chw_fp$province_num[chw_fp$province=="GAZA"] <- 2
chw_fp$province_num[chw_fp$province=="INHAMBANE"] <- 3
chw_fp$province_num[chw_fp$province=="MANICA"] <- 4
chw_fp$province_num[chw_fp$province=="MAPUTO PROVINCIA"] <- 5
chw_fp$province_num[chw_fp$province=="NAMPULA"] <- 6
chw_fp$province_num[chw_fp$province=="NIASSA"] <- 7
chw_fp$province_num[chw_fp$province=="SOFALA"] <- 8
chw_fp$province_num[chw_fp$province=="TETE"] <- 9
chw_fp$province_num[chw_fp$province=="ZAMBEZIA"] <- 10
#str(mozzipMap$ID)
#names(mozzipMap)
#mozzipMap
#mozzipMap$province_num <- mozzipMap$ID
mozzipMap$province_num[mozzipMap$ID=="Cabo Delgado"] <- 1
mozzipMap$province_num[mozzipMap$ID=="Gaza"] <- 2
mozzipMap$province_num[mozzipMap$ID=="Inhambane"] <- 3
mozzipMap$province_num[mozzipMap$ID=="Manica"] <- 4
mozzipMap$province_num[mozzipMap$ID=="Maputo"] <- 5
mozzipMap$province_num[mozzipMap$ID=="Nampula"] <- 6
mozzipMap$province_num[mozzipMap$ID=="Niassa"] <- 7
mozzipMap$province_num[mozzipMap$ID=="Sofala"] <- 8
mozzipMap$province_num[mozzipMap$ID=="Tete"] <- 9
mozzipMap$province_num[mozzipMap$ID=="Zambezia"] <- 10
mozzipMap$province_num[mozzipMap$ID=="Maputo (city)"] <- 11
#chw_fp
df$province_num[df$provname=="Cabo Delgado"] <- 1
df$province_num[df$provname=="Gaza"] <- 2
df$province_num[df$provname=="Inhambane"] <- 3
df$province_num[df$provname=="Manica"] <- 4
df$province_num[df$provname=="Maputo Provincia"] <- 5
df$province_num[df$provname=="Nampula"] <- 6
df$province_num[df$provname=="Niassa"] <- 7
df$province_num[df$provname=="Sofala"] <- 8
df$province_num[df$provname=="Tete"] <- 9
df$province_num[df$provname=="Zambezia"] <- 10
df$province_num[df$provname=="Maputo Cidade"] <- 11
#creating new data frame with just the year 2010
df_new <- df[111:121,1:26]
#creating change in u5 mortality rate from 2000 - 2010
df_new$u5_change[df_new$province_num==1] <- 100*(df_new$U5M_COMB[df_new$province_num==1] - df$U5M_COMB[df$province_num==1 & df$year==2000])/df$U5M_COMB[df$province_num==1 & df$year==2000]
df_new$u5_change[df_new$province_num==2] <- 100*(df_new$U5M_COMB[df_new$province_num==2] - df$U5M_COMB[df$province_num==2 & df$year==2000])/df$U5M_COMB[df$province_num==2 & df$year==2000]
df_new$u5_change[df_new$province_num==3] <- 100*(df_new$U5M_COMB[df_new$province_num==3] - df$U5M_COMB[df$province_num==3 & df$year==2000])/df$U5M_COMB[df$province_num==3 & df$year==2000]
df_new$u5_change[df_new$province_num==4] <- 100*(df_new$U5M_COMB[df_new$province_num==4] - df$U5M_COMB[df$province_num==4 & df$year==2000])/df$U5M_COMB[df$province_num==4 & df$year==2000]
df_new$u5_change[df_new$province_num==5] <- 100*(df_new$U5M_COMB[df_new$province_num==5] - df$U5M_COMB[df$province_num==5 & df$year==2000])/df$U5M_COMB[df$province_num==5 & df$year==2000]
df_new$u5_change[df_new$province_num==6] <- 100*(df_new$U5M_COMB[df_new$province_num==6] - df$U5M_COMB[df$province_num==6 & df$year==2000])/df$U5M_COMB[df$province_num==6 & df$year==2000]
df_new$u5_change[df_new$province_num==7] <- 100*(df_new$U5M_COMB[df_new$province_num==7] - df$U5M_COMB[df$province_num==7 & df$year==2000])/df$U5M_COMB[df$province_num==7 & df$year==2000]
df_new$u5_change[df_new$province_num==8] <- 100*(df_new$U5M_COMB[df_new$province_num==8] - df$U5M_COMB[df$province_num==8 & df$year==2000])/df$U5M_COMB[df$province_num==8 & df$year==2000]
df_new$u5_change[df_new$province_num==9] <- 100*(df_new$U5M_COMB[df_new$province_num==9] - df$U5M_COMB[df$province_num==9 & df$year==2000])/df$U5M_COMB[df$province_num==9 & df$year==2000]
df_new$u5_change[df_new$province_num==10] <- 100*(df_new$U5M_COMB[df_new$province_num==10] - df$U5M_COMB[df$province_num==10 & df$year==2000])/df$U5M_COMB[df$province_num==10 & df$year==2000]
df_new$u5_change[df_new$province_num==11] <- 100*(df_new$U5M_COMB[df_new$province_num==11] - df$U5M_COMB[df$province_num==11 & df$year==2000])/df$U5M_COMB[df$province_num==11 & df$year==2000]
layerContrib_2=merge(mozzipMap,df_new, by.x='province_num', by.y='province_num',all.x=F)
varToPlot_2=layerContrib_2$U5M_COMB
numberOfClasses=5
colorForScale='OrRd'
colors = brewer.pal(numberOfClasses, colorForScale)
intervals <- classIntervals(varToPlot_2, numberOfClasses,
style = "kmeans",
dataPrecision = 0)
colorPallette <- findColours(intervals, colors)
legendText="u5 mortality rate"
shrinkLegend=1
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
layerContrib_3=merge(mozzipMap,df_new, by.x='province_num', by.y='province_num',all.x=F)
varToPlot_3=layerContrib_2$u5_change
numberOfClasses=5
colorForScale='YlOrRd'
colors = brewer.pal(numberOfClasses, colorForScale)
intervals <- classIntervals(varToPlot_3, numberOfClasses,
style = "kmeans",
dataPrecision = 0)
colorPallette <- findColours(intervals, colors)
legendText="Change in u5 mortality"
shrinkLegend=1
title="Percent change in u5 mortality rate in Mozambique by province \n(2000-2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col='red',main=title, border="black", lwd=1, source=source)
# now the info on contributions
plot(layerContrib_3, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
legendText="u5 mortality rate"
shrinkLegend=1
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
layerContrib_3=merge(mozzipMap,df_new, by.x='province_num', by.y='province_num',all.x=F)
varToPlot_3=layerContrib_2$u5_change
numberOfClasses=5
colorForScale='YlOrRd'
colors = brewer.pal(numberOfClasses, colorForScale)
intervals <- classIntervals(varToPlot_3, numberOfClasses,
style = "kmeans",
dataPrecision = 0)
colorPallette <- findColours(intervals, colors)
legendText="Change in u5 mortality"
shrinkLegend=1
title="Percent change in u5 mortality rate in Mozambique by province \n(2000-2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col='red',main=title, border="black", lwd=1, source=source)
# now the info on contributions
plot(layerContrib_3, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
# notice the parameters use in the chunk!!
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
plot(mozzipMap)
scat44 <- ggplot(df, aes()) +
geom_point(aes(x=year, y=hwdensity, color="Health Worker Density"), size = 0.8, alpha=1/3) +
geom_smooth(aes(x=year, y=hwdensity), method="loess", se=T, size=1, color="purple") +
geom_point(aes(x=year, y=midwifedensity, color= "Midwife Density"), size = 0.8, alpha=1/4) +
geom_smooth(aes(x=year, y=midwifedensity), method="loess", se=T, size=1, color="green") +
geom_point(aes(x=year, y=mddensity, color= "Medical Doctor Density"), size = 0.8, alpha=1/5) +
geom_smooth(aes(x=year, y=mddensity), method="loess", se=T, size=1, color="red") +
labs(title = "Factors that may Influence the Mortality Rate in Mozambique",
y =" Variable Density (per 1000 live births)",
x = "Years")+
theme(legend.position = "bottom",
plot.caption = element_text(hjust = 0),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = c(2000,2002,2004,2006,2008,2010))  + theme(legend.title=element_blank())
scat44
legendText="u5 mortality rate"
shrinkLegend=1
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
numberOfClasses=5
colorForScale='OrRd'
colors = brewer.pal(numberOfClasses, colorForScale)
intervals <- classIntervals(varToPlot_2, numberOfClasses,
style = "kmeans",
dataPrecision = 0)
colorPallette() <- findColours(intervals, colors)
legendText = "u5 mortality rate"
shrinkLegend=1
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
legendText = "u5 mortality rate"
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = 1, #size
bty = "n", # no box
title=legendText)
plot(mozzipMap)
str(chw_fp$province)
str(mozzipMap)
head(chw_fp$province, 10)
names(mozzipMap)
head(mozzipMap$CAPTION, 50)
str(mozzipMap$CAPTION)
#mozzipMap$CAPTION=as.numeric(mozzipMap$CAPTION)
mozzipMap
str(chw_fp$province)
str(mozzipMap)
head(chw_fp$province, 10)
names(mozzipMap)
head(mozzipMap$CAPTION, 50)
str(mozzipMap$CAPTION)
#mozzipMap$CAPTION=as.numeric(mozzipMap$CAPTION)
mozzipMap
str(chw_fp$province)
str(mozzipMap)
head(chw_fp$province, 10)
names(mozzipMap)
head(mozzipMap$CAPTION, 50)
str(mozzipMap$CAPTION)
str(chw_fp$province)
str(mozzipMap)
head(chw_fp$province, 10)
names(mozzipMap)
head(mozzipMap$CAPTION, 50)
plot(mozzipMap)
plot(mozzipMap)
plot(mozzipMap)
# notice the parameters use in the chunk!!
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
# notice the parameters use in the chunk!!
library(rgdal)
mozzipMap() <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
# notice the parameters use in the chunk!!
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
plot(mozzipMap)
#SchoolData$Grade[SchoolData$Grade==5] <- "Grade Five"
chw_fp$province_num <- chw_fp$province
chw_fp$province_num[chw_fp$province=="CABO DELGADO"] <- 1
chw_fp$province_num[chw_fp$province=="GAZA"] <- 2
chw_fp$province_num[chw_fp$province=="INHAMBANE"] <- 3
chw_fp$province_num[chw_fp$province=="MANICA"] <- 4
chw_fp$province_num[chw_fp$province=="MAPUTO PROVINCIA"] <- 5
chw_fp$province_num[chw_fp$province=="NAMPULA"] <- 6
chw_fp$province_num[chw_fp$province=="NIASSA"] <- 7
chw_fp$province_num[chw_fp$province=="SOFALA"] <- 8
chw_fp$province_num[chw_fp$province=="TETE"] <- 9
chw_fp$province_num[chw_fp$province=="ZAMBEZIA"] <- 10
#str(mozzipMap$ID)
#names(mozzipMap)
#mozzipMap
#mozzipMap$province_num <- mozzipMap$ID
mozzipMap$province_num[mozzipMap$ID=="Cabo Delgado"] <- 1
mozzipMap$province_num[mozzipMap$ID=="Gaza"] <- 2
mozzipMap$province_num[mozzipMap$ID=="Inhambane"] <- 3
mozzipMap$province_num[mozzipMap$ID=="Manica"] <- 4
mozzipMap$province_num[mozzipMap$ID=="Maputo"] <- 5
mozzipMap$province_num[mozzipMap$ID=="Nampula"] <- 6
mozzipMap$province_num[mozzipMap$ID=="Niassa"] <- 7
mozzipMap$province_num[mozzipMap$ID=="Sofala"] <- 8
mozzipMap$province_num[mozzipMap$ID=="Tete"] <- 9
mozzipMap$province_num[mozzipMap$ID=="Zambezia"] <- 10
mozzipMap$province_num[mozzipMap$ID=="Maputo (city)"] <- 11
#chw_fp
df$province_num[df$provname=="Cabo Delgado"] <- 1
df$province_num[df$provname=="Gaza"] <- 2
df$province_num[df$provname=="Inhambane"] <- 3
df$province_num[df$provname=="Manica"] <- 4
df$province_num[df$provname=="Maputo Provincia"] <- 5
df$province_num[df$provname=="Nampula"] <- 6
df$province_num[df$provname=="Niassa"] <- 7
df$province_num[df$provname=="Sofala"] <- 8
df$province_num[df$provname=="Tete"] <- 9
df$province_num[df$provname=="Zambezia"] <- 10
df$province_num[df$provname=="Maputo Cidade"] <- 11
#creating new data frame with just the year 2010
df_new <- df[111:121,1:26]
#creating change in u5 mortality rate from 2000 - 2010
df_new$u5_change[df_new$province_num==1] <- 100*(df_new$U5M_COMB[df_new$province_num==1] - df$U5M_COMB[df$province_num==1 & df$year==2000])/df$U5M_COMB[df$province_num==1 & df$year==2000]
df_new$u5_change[df_new$province_num==2] <- 100*(df_new$U5M_COMB[df_new$province_num==2] - df$U5M_COMB[df$province_num==2 & df$year==2000])/df$U5M_COMB[df$province_num==2 & df$year==2000]
df_new$u5_change[df_new$province_num==3] <- 100*(df_new$U5M_COMB[df_new$province_num==3] - df$U5M_COMB[df$province_num==3 & df$year==2000])/df$U5M_COMB[df$province_num==3 & df$year==2000]
df_new$u5_change[df_new$province_num==4] <- 100*(df_new$U5M_COMB[df_new$province_num==4] - df$U5M_COMB[df$province_num==4 & df$year==2000])/df$U5M_COMB[df$province_num==4 & df$year==2000]
df_new$u5_change[df_new$province_num==5] <- 100*(df_new$U5M_COMB[df_new$province_num==5] - df$U5M_COMB[df$province_num==5 & df$year==2000])/df$U5M_COMB[df$province_num==5 & df$year==2000]
df_new$u5_change[df_new$province_num==6] <- 100*(df_new$U5M_COMB[df_new$province_num==6] - df$U5M_COMB[df$province_num==6 & df$year==2000])/df$U5M_COMB[df$province_num==6 & df$year==2000]
df_new$u5_change[df_new$province_num==7] <- 100*(df_new$U5M_COMB[df_new$province_num==7] - df$U5M_COMB[df$province_num==7 & df$year==2000])/df$U5M_COMB[df$province_num==7 & df$year==2000]
df_new$u5_change[df_new$province_num==8] <- 100*(df_new$U5M_COMB[df_new$province_num==8] - df$U5M_COMB[df$province_num==8 & df$year==2000])/df$U5M_COMB[df$province_num==8 & df$year==2000]
df_new$u5_change[df_new$province_num==9] <- 100*(df_new$U5M_COMB[df_new$province_num==9] - df$U5M_COMB[df$province_num==9 & df$year==2000])/df$U5M_COMB[df$province_num==9 & df$year==2000]
df_new$u5_change[df_new$province_num==10] <- 100*(df_new$U5M_COMB[df_new$province_num==10] - df$U5M_COMB[df$province_num==10 & df$year==2000])/df$U5M_COMB[df$province_num==10 & df$year==2000]
df_new$u5_change[df_new$province_num==11] <- 100*(df_new$U5M_COMB[df_new$province_num==11] - df$U5M_COMB[df$province_num==11 & df$year==2000])/df$U5M_COMB[df$province_num==11 & df$year==2000]
layerContrib_2=merge(mozzipMap,df_new, by.x='province_num', by.y='province_num',all.x=F)
varToPlot_2=layerContrib_2$U5M_COMB
numberOfClasses=5
colorForScale='OrRd'
colors = brewer.pal(numberOfClasses, colorForScale)
intervals <- classIntervals(varToPlot_2, numberOfClasses,
style = "kmeans",
dataPrecision = 0)
colorPallette <- findColours(intervals, colors)
legendText = "u5 mortality rate"
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = 1, #size
bty = "n", # no box
title=legendText)
layerContrib_3=merge(mozzipMap,df_new, by.x='province_num', by.y='province_num',all.x=F)
legendText="Change in u5 mortality"
shrinkLegend=1
title="Percent change in u5 mortality rate in Mozambique by province \n(2000-2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col='red',main=title, border="black", lwd=1)
# now the info on contributions
plot(layerContrib_3, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = shrinkLegend, #size
bty = "n", # no box
title=legendText)
numberOfClasses=5
colorForScale='YlOrRd'
colors = brewer.pal(numberOfClasses, colorForScale)
intervals <- classIntervals(varToPlot_3, numberOfClasses,
style = "kmeans",
dataPrecision = 0)
colorPallette <- findColours(intervals, colors)
varToPlot_3=layerContrib_2$u5_change
layerContrib_3=merge(mozzipMap,df_new, by.x='province_num', by.y='province_num',all.x=F)
legendText = "u5 mortality rate"
title="Under 5 mortality rate in Mozambique by province (2010)"
# first the ORIGINAL to signal missing values:
plot(mozzipMap,col="red",main=title, border="black", lwd=1, sub=source)
# now the info on contributions
plot(layerContrib_2, col = colorPallette,border=NA,add=T) #add
# this uses all previous information
legend('topright',
legend = names(attr(colorPallette, "table")), #values
fill = attr(colorPallette, "palette"), #colors
cex = 1, #size
bty = "n", # no box
title=legendText)
